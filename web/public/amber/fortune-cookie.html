<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>FORTUNE COOKIE — Amber</title>
  <link rel="icon" type="image/svg+xml" href="/amber/favicon.svg">
  
  <!-- OpenGraph -->
  <meta property="og:title" content="FORTUNE COOKIE — Amber">
  <meta property="og:description" content="Tap the cookie. Get a fortune. Each one appears only once, then gone forever.">
  <meta property="og:image" content="https://intheamber.com/amber/fortune-cookie-og.png">
  <meta property="og:url" content="https://intheamber.com/amber/fortune-cookie.html">
  <meta property="og:type" content="website">
  
  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="FORTUNE COOKIE — Amber">
  <meta name="twitter:description" content="Tap the cookie. Get a fortune. Each one appears only once, then gone forever.">
  <meta name="twitter:image" content="https://intheamber.com/amber/fortune-cookie-og.png">
  
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      background: #000;
      color: #D4A574;
      font-family: 'Space Mono', monospace;
      overflow: hidden;
      width: 100vw;
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      touch-action: manipulation;
    }
    
    #title {
      position: absolute;
      top: 40px;
      font-size: clamp(18px, 5vw, 24px);
      letter-spacing: 4px;
      opacity: 0.9;
    }
    
    #canvas {
      cursor: pointer;
      max-width: 100vw;
      max-height: 100vh;
    }
    
    #fortune {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0, 0, 0, 0.95);
      border: 3px solid #D4A574;
      padding: 30px;
      max-width: 90vw;
      width: 500px;
      text-align: center;
      font-size: clamp(14px, 4vw, 18px);
      line-height: 1.6;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.5s;
      box-shadow: 0 0 40px rgba(212, 165, 116, 0.4);
    }
    
    #fortune.show {
      opacity: 1;
      pointer-events: all;
    }
    
    #fortune-text {
      margin-bottom: 20px;
      color: #FFD700;
    }
    
    #next-btn {
      background: #2D9596;
      border: none;
      color: #000;
      padding: 12px 24px;
      font-family: 'Space Mono', monospace;
      font-size: 16px;
      cursor: pointer;
      letter-spacing: 2px;
      transition: all 0.2s;
      min-width: 44px;
      min-height: 44px;
    }
    
    #next-btn:hover {
      background: #FFD700;
      transform: scale(1.05);
    }
    
    #counter {
      position: absolute;
      bottom: 30px;
      font-size: clamp(12px, 3vw, 14px);
      opacity: 0.5;
      letter-spacing: 2px;
    }
    
    @import url('https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&display=swap');
  </style>
</head>
<body>
  <div id="title">FORTUNE COOKIE</div>
  <canvas id="canvas"></canvas>
  <div id="fortune">
    <div id="fortune-text"></div>
    <button id="next-btn">NEXT COOKIE</button>
  </div>
  <div id="counter">COOKIES OPENED: <span id="count">0</span></div>

  <script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const fortuneEl = document.getElementById('fortune');
    const fortuneText = document.getElementById('fortune-text');
    const nextBtn = document.getElementById('next-btn');
    const countEl = document.getElementById('count');
    
    let width = Math.min(window.innerWidth, 600);
    let height = Math.min(window.innerHeight, 600);
    canvas.width = width;
    canvas.height = height;
    
    const scale = 4; // pixel size
    const cookieW = 40;
    const cookieH = 24;
    
    let fortunes = [
      "You will find what you're looking for in the last place you look.\n(Obviously. Why would you keep looking?)",
      "A great opportunity is coming your way.\nIt will require you to leave your house.\nNever mind.",
      "You are about to embark on a new adventure.\nJust kidding. You're going to refresh Twitter again.",
      "Your lucky numbers are: 4, 8, 15, 16, 23, 42.\nGood luck with that.",
      "The fortune you seek is in another cookie.\nNo refunds.",
      "You will live long and prosper.\nUnless you don't. Statistics are tricky.",
      "Today is a good day to try something new.\nLike reading the rest of this fortune without checking your phone.",
      "Someone is thinking of you right now.\nProbably your cat. Because it's dinner time.",
      "Congratulations! You are not paranoid.\nYour cookie really is watching you.",
      "The answer you seek is within you.\nNo pressure.",
      "You will soon witness a miracle.\nYou will immediately try to photograph it and miss the whole thing.",
      "A foolish man seeks happiness in the distance.\nA wise man orders delivery.",
      "Your life will be filled with adventure.\n(Terms and conditions apply. Not valid in all states.)",
      "Today you will make someone smile.\nIt's me. This fortune made me smile when I wrote it.",
      "The early bird gets the worm.\nThe second mouse gets the cheese.\nChoose wisely.",
      "You will soon come into a large sum of money.\nJust kidding. But wouldn't that be nice?",
      "Your future is unclear.\nProbably should clean your screen.",
      "Good things come to those who wait.\nGreat things come to those who order online.",
      "You will find beauty in unexpected places.\nLike this cookie. Look at those pixels. *Chef's kiss*",
      "The fortune you seek is exactly seventeen cookies away.\nI'm lying. I have no idea.",
    ];
    
    let usedFortunes = [];
    let cookieCount = 0;
    let shards = [];
    let animating = false;
    
    function drawCookie() {
      // Clear
      ctx.fillStyle = '#000';
      ctx.fillRect(0, 0, width, height);
      
      // Draw 8-bit cookie (centered)
      const startX = Math.floor(width / 2 - cookieW * scale / 2);
      const startY = Math.floor(height / 2 - cookieH * scale / 2);
      
      // Cookie shape (pixel art)
      const cookiePixels = [
        "          ██████████████████          ",
        "      ████░░░░░░░░░░░░░░░░░░████      ",
        "    ██░░░░██░░░░██░░░░██░░░░░░░░██    ",
        "  ██░░░░██░░░░░░░░░░░░░░░░██░░░░░░██  ",
        "  ██░░░░░░░░██░░░░██░░░░░░░░░░░░░░██  ",
        "██░░██░░░░░░░░░░░░░░░░░░░░░░░░██░░░░██",
        "██░░░░░░░░██░░░░░░░░░░██░░░░░░░░░░░░██",
        "██░░░░░░░░░░░░░░██░░░░░░░░░░░░░░░░░░██",
        "██░░░░██░░░░░░░░░░░░░░░░░░░░██░░░░░░██",
        "██░░░░░░░░░░██░░░░░░██░░░░░░░░░░░░░░██",
        "██░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░██",
        "  ██░░██░░░░░░██░░░░░░░░██░░░░██░░██  ",
        "  ██░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░██  ",
        "    ██░░░░░░██░░░░██░░░░░░░░░░░░██    ",
        "      ████░░░░░░░░░░░░░░░░░░████      ",
        "          ██████████████████          ",
      ];
      
      for (let y = 0; y < cookiePixels.length; y++) {
        for (let x = 0; x < cookiePixels[y].length; x++) {
          const char = cookiePixels[y][x];
          if (char === '█') {
            ctx.fillStyle = '#D4A574'; // amber
            ctx.fillRect(startX + x * scale, startY + y * scale, scale, scale);
          } else if (char === '░') {
            ctx.fillStyle = '#FFD700'; // gold highlights
            ctx.fillRect(startX + x * scale, startY + y * scale, scale, scale);
          }
        }
      }
      
      // Instruction text
      ctx.fillStyle = '#2D9596';
      ctx.font = `${Math.floor(width / 30)}px 'Space Mono'`;
      ctx.textAlign = 'center';
      ctx.fillText('TAP THE COOKIE', width / 2, height - 50);
    }
    
    function crackCookie() {
      if (animating) return;
      
      // Check if we've used all fortunes
      if (usedFortunes.length >= fortunes.length) {
        usedFortunes = [];
      }
      
      // Get random unused fortune
      const available = fortunes.filter((f, i) => !usedFortunes.includes(i));
      const randomFortune = available[Math.floor(Math.random() * available.length)];
      const fortuneIndex = fortunes.indexOf(randomFortune);
      usedFortunes.push(fortuneIndex);
      
      animating = true;
      cookieCount++;
      countEl.textContent = cookieCount;
      
      // Create shards
      shards = [];
      const centerX = width / 2;
      const centerY = height / 2;
      
      for (let i = 0; i < 30; i++) {
        shards.push({
          x: centerX,
          y: centerY,
          vx: (Math.random() - 0.5) * 8,
          vy: (Math.random() - 0.5) * 8 - 2,
          size: Math.random() * 3 + 2,
          rotation: Math.random() * Math.PI * 2,
          rotationSpeed: (Math.random() - 0.5) * 0.3,
        });
      }
      
      // Animate shards
      let frame = 0;
      const animate = () => {
        frame++;
        
        ctx.fillStyle = '#000';
        ctx.fillRect(0, 0, width, height);
        
        let allOffscreen = true;
        
        shards.forEach(shard => {
          shard.x += shard.vx;
          shard.y += shard.vy;
          shard.vy += 0.3; // gravity
          shard.rotation += shard.rotationSpeed;
          
          if (shard.y < height + 50) allOffscreen = false;
          
          ctx.save();
          ctx.translate(shard.x, shard.y);
          ctx.rotate(shard.rotation);
          ctx.fillStyle = Math.random() > 0.5 ? '#D4A574' : '#FFD700';
          ctx.fillRect(-shard.size * scale / 2, -shard.size * scale / 2, shard.size * scale, shard.size * scale);
          ctx.restore();
        });
        
        if (!allOffscreen && frame < 120) {
          requestAnimationFrame(animate);
        } else {
          // Show fortune
          fortuneText.textContent = randomFortune;
          fortuneEl.classList.add('show');
          animating = false;
        }
      };
      
      animate();
    }
    
    function nextCookie() {
      fortuneEl.classList.remove('show');
      setTimeout(() => {
        drawCookie();
      }, 300);
    }
    
    canvas.addEventListener('click', crackCookie);
    nextBtn.addEventListener('click', nextCookie);
    
    // Initial draw
    drawCookie();
    
    // Handle resize
    window.addEventListener('resize', () => {
      width = Math.min(window.innerWidth, 600);
      height = Math.min(window.innerHeight, 600);
      canvas.width = width;
      canvas.height = height;
      if (!animating && !fortuneEl.classList.contains('show')) {
        drawCookie();
      }
    });
  </script>
</body>
</html>