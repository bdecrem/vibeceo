<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RIPPLE — Tap when the rings align</title>
  
  <!-- Open Graph tags -->
  <meta property="og:title" content="RIPPLE — Tap when the rings align">
  <meta property="og:description" content="A minimalist timing game. Tap when rings align. Miss the moment, lose the rhythm.">
  <meta property="og:image" content="https://intheamber.com/amber/ripple-og.png">
  <meta property="og:url" content="https://intheamber.com/amber/ripple.html">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="RIPPLE — Tap when the rings align">
  <meta name="twitter:description" content="A minimalist timing game. Tap when rings align. Miss the moment, lose the rhythm.">
  <meta name="twitter:image" content="https://intheamber.com/amber/ripple-og.png">
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      background: #000;
      color: #D4A574;
      font-family: 'Space Mono', monospace;
      overflow: hidden;
      touch-action: manipulation;
      user-select: none;
    }
    
    #canvas {
      display: block;
      width: 100vw;
      height: 100vh;
      cursor: pointer;
    }
    
    #ui {
      position: fixed;
      top: 20px;
      left: 20px;
      right: 20px;
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      pointer-events: none;
      z-index: 10;
    }
    
    .stat {
      background: rgba(0,0,0,0.8);
      padding: 12px 20px;
      border: 1px solid #D4A574;
      font-size: 14px;
      line-height: 1.6;
    }
    
    .stat-label {
      opacity: 0.6;
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    .stat-value {
      font-size: 24px;
      color: #FFD700;
    }
    
    #message {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
      pointer-events: none;
      z-index: 5;
    }
    
    #message h1 {
      font-size: 48px;
      color: #FFD700;
      margin-bottom: 20px;
      text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
    }
    
    #message p {
      font-size: 18px;
      margin-bottom: 10px;
      opacity: 0.8;
    }
    
    #message button {
      margin-top: 30px;
      padding: 15px 40px;
      background: #000;
      color: #FFD700;
      border: 2px solid #FFD700;
      font-family: 'Space Mono', monospace;
      font-size: 16px;
      cursor: pointer;
      pointer-events: auto;
      transition: all 0.2s;
    }
    
    #message button:hover {
      background: #FFD700;
      color: #000;
    }
    
    .speed-warning {
      animation: pulse 0.5s ease-in-out;
    }
    
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }
    
    .perfect {
      color: #2D9596 !important;
      text-shadow: 0 0 20px rgba(45, 149, 150, 0.8);
    }
  </style>
</head>
<body>
  <canvas id="canvas"></canvas>
  
  <div id="ui">
    <div class="stat">
      <div class="stat-label">Score</div>
      <div class="stat-value" id="score">0</div>
    </div>
    <div class="stat">
      <div class="stat-label">Speed</div>
      <div class="stat-value" id="speed">1.0x</div>
    </div>
    <div class="stat">
      <div class="stat-label">Best</div>
      <div class="stat-value" id="best">0</div>
    </div>
  </div>
  
  <div id="message">
    <h1>RIPPLE</h1>
    <p>Tap when the traveling ring</p>
    <p>aligns with the target ring</p>
    <p style="margin-top: 20px; opacity: 0.5; font-size: 14px;">Perfect timing required</p>
    <button id="startBtn">START</button>
  </div>

  <script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const scoreEl = document.getElementById('score');
    const speedEl = document.getElementById('speed');
    const bestEl = document.getElementById('best');
    const messageEl = document.getElementById('message');
    const startBtn = document.getElementById('startBtn');
    
    let width, height, centerX, centerY;
    
    function resize() {
      width = canvas.width = window.innerWidth;
      height = canvas.height = window.innerHeight;
      centerX = width / 2;
      centerY = height / 2;
    }
    resize();
    window.addEventListener('resize', resize);
    
    // Audio context
    let audioCtx;
    function initAudio() {
      if (!audioCtx) {
        audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      }
    }
    
    function playTone(freq, duration = 0.1, type = 'sine') {
      if (!audioCtx) return;
      const osc = audioCtx.createOscillator();
      const gain = audioCtx.createGain();
      osc.connect(gain);
      gain.connect(audioCtx.destination);
      osc.frequency.value = freq;
      osc.type = type;
      gain.gain.setValueAtTime(0.3, audioCtx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + duration);
      osc.start();
      osc.stop(audioCtx.currentTime + duration);
    }
    
    // Game state
    let gameState = 'start'; // start, playing, gameOver
    let score = 0;
    let speed = 1.0;
    let bestScore = parseInt(localStorage.getItem('ripple_best') || '0');
    bestEl.textContent = bestScore;
    
    // Target ring (static)
    const targetRadius = Math.min(width, height) * 0.15;
    
    // Traveling ring
    let travelRing = null;
    
    // Particles
    let particles = [];
    
    class TravelRing {
      constructor() {
        this.radius = 0;
        this.maxRadius = Math.min(width, height) * 0.5;
        this.speed = 2 * speed; // pixels per frame
        this.alive = true;
      }
      
      update() {
        this.radius += this.speed;
        if (this.radius > this.maxRadius) {
          this.alive = false;
          // Missed - game over
          if (gameState === 'playing') {
            gameOver();
          }
        }
      }
      
      draw() {
        ctx.strokeStyle = '#2D9596';
        ctx.lineWidth = 3;
        ctx.beginPath();
        ctx.arc(centerX, centerY, this.radius, 0, Math.PI * 2);
        ctx.stroke();
      }
      
      isInTargetZone() {
        const tolerance = 15; // pixels
        return Math.abs(this.radius - targetRadius) < tolerance;
      }
      
      isPerfect() {
        const perfectTolerance = 5; // pixels
        return Math.abs(this.radius - targetRadius) < perfectTolerance;
      }
    }
    
    class Particle {
      constructor(x, y, color) {
        const angle = Math.random() * Math.PI * 2;
        const speed = 2 + Math.random() * 4;
        this.x = x;
        this.y = y;
        this.vx = Math.cos(angle) * speed;
        this.vy = Math.sin(angle) * speed;
        this.color = color;
        this.life = 1;
        this.decay = 0.02;
        this.radius = 2 + Math.random() * 3;
      }
      
      update() {
        this.x += this.vx;
        this.y += this.vy;
        this.life -= this.decay;
      }
      
      draw() {
        ctx.fillStyle = this.color;
        ctx.globalAlpha = this.life;
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
        ctx.fill();
        ctx.globalAlpha = 1;
      }
    }
    
    function spawnRing() {
      travelRing = new TravelRing();
    }
    
    function onTap() {
      if (gameState === 'start') return;
      if (gameState === 'gameOver') return;
      if (!travelRing || !travelRing.alive) return;
      
      initAudio();
      
      if (travelRing.isInTargetZone()) {
        // Success!
        const perfect = travelRing.isPerfect();
        score++;
        scoreEl.textContent = score;
        
        // Speed up every 5 points
        if (score % 5 === 0) {
          speed += 0.1;
          speedEl.textContent = speed.toFixed(1) + 'x';
          speedEl.classList.add('speed-warning');
          setTimeout(() => speedEl.classList.remove('speed-warning'), 500);
        }
        
        // Particles
        const color = perfect ? '#2D9596' : '#FFD700';
        for (let i = 0; i < (perfect ? 20 : 12); i++) {
          particles.push(new Particle(centerX, centerY, color));
        }
        
        // Audio
        if (perfect) {
          playTone(1200, 0.15);
          scoreEl.classList.add('perfect');
          setTimeout(() => scoreEl.classList.remove('perfect'), 300);
        } else {
          playTone(800, 0.1);
        }
        
        // Next ring
        travelRing = null;
        setTimeout(spawnRing, 200 / speed);
      } else {
        // Missed - too early or too late
        gameOver();
      }
    }
    
    function gameOver() {
      gameState = 'gameOver';
      playTone(200, 0.5, 'sawtooth');
      
      // Update best
      if (score > bestScore) {
        bestScore = score;
        localStorage.setItem('ripple_best', bestScore.toString());
        bestEl.textContent = bestScore;
        messageEl.innerHTML = `
          <h1>NEW BEST!</h1>
          <p style="font-size: 48px; color: #2D9596; margin: 20px 0;">${score}</p>
          <p>Perfect timing achieved</p>
          <button id="retryBtn">RETRY</button>
        `;
      } else {
        messageEl.innerHTML = `
          <h1>MISSED</h1>
          <p style="font-size: 36px; color: #FFD700; margin: 20px 0;">Score: ${score}</p>
          <p style="opacity: 0.6;">Timing is everything</p>
          <button id="retryBtn">RETRY</button>
        `;
      }
      
      messageEl.style.display = 'block';
      document.getElementById('retryBtn').addEventListener('click', startGame);
    }
    
    function startGame() {
      initAudio();
      gameState = 'playing';
      score = 0;
      speed = 1.0;
      scoreEl.textContent = score;
      speedEl.textContent = speed.toFixed(1) + 'x';
      messageEl.style.display = 'none';
      particles = [];
      travelRing = null;
      
      playTone(400, 0.1);
      spawnRing();
    }
    
    startBtn.addEventListener('click', startGame);
    canvas.addEventListener('click', onTap);
    canvas.addEventListener('touchstart', (e) => {
      e.preventDefault();
      onTap();
    });
    
    // Draw loop
    function draw() {
      // Fade background
      ctx.fillStyle = 'rgba(0, 0, 0, 0.1)';
      ctx.fillRect(0, 0, width, height);
      
      // Draw target ring (static)
      ctx.strokeStyle = '#D4A574';
      ctx.lineWidth = 4;
      ctx.beginPath();
      ctx.arc(centerX, centerY, targetRadius, 0, Math.PI * 2);
      ctx.stroke();
      
      // Glow on target ring
      ctx.strokeStyle = 'rgba(212, 165, 116, 0.3)';
      ctx.lineWidth = 12;
      ctx.beginPath();
      ctx.arc(centerX, centerY, targetRadius, 0, Math.PI * 2);
      ctx.stroke();
      
      // Center dot
      ctx.fillStyle = '#FFD700';
      ctx.beginPath();
      ctx.arc(centerX, centerY, 6, 0, Math.PI * 2);
      ctx.fill();
      
      // Traveling ring
      if (travelRing && travelRing.alive) {
        travelRing.update();
        travelRing.draw();
        
        // Highlight when in target zone
        if (travelRing.isInTargetZone()) {
          ctx.strokeStyle = 'rgba(45, 149, 150, 0.5)';
          ctx.lineWidth = 8;
          ctx.beginPath();
          ctx.arc(centerX, centerY, travelRing.radius, 0, Math.PI * 2);
          ctx.stroke();
        }
      }
      
      // Particles
      particles = particles.filter(p => p.life > 0);
      particles.forEach(p => {
        p.update();
        p.draw();
      });
      
      requestAnimationFrame(draw);
    }
    
    draw();
  </script>
</body>
</html>