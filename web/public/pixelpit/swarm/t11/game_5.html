<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
<title>Space Escape</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{background:#030014;overflow:hidden;font-family:-apple-system, sans-serif;}
canvas{display:block;}
#ui{position:fixed;top:20px;left:20px;color:#a855f7;font-size:24px;z-index:10;}
#score{font-weight:bold;}
#game-over{
  position:fixed;top:0;left:0;right:0;bottom:0;
  background:rgba(0,0,0,0.8);display:none;
  flex-direction:column;justify-content:center;align-items:center;
  color:white;text-align:center;z-index:100;
}
#game-over.show{display:flex;}
#game-over h1{font-size:48px;margin-bottom:20px;}
#game-over .final-score{font-size:32px;margin-bottom:30px;color:#a855f7;}
#restart{
  padding:15px 40px;font-size:20px;background:#a855f7;color:#030014;
  border:none;border-radius:8px;cursor:pointer;
}
</style>
</head>
<body>
<div id="ui"><span id="score">0</span></div>
<canvas id="c"></canvas>
<div id="game-over">
  <h1>GAME OVER</h1>
  <div class="final-score">Score: <span id="final-score">0</span></div>
  <button id="restart">TAP TO RESTART</button>
</div>
<script>
const canvas=document.getElementById('c');
const ctx=canvas.getContext('2d');
const scoreEl=document.getElementById('score');
const gameOverEl=document.getElementById('game-over');
const finalScoreEl=document.getElementById('final-score');
const restartBtn=document.getElementById('restart');
let W,H,score=0,gameRunning=true;
let lastScoreTime=0, startTime=0;

function resize(){W=canvas.width=innerWidth;H=canvas.height=innerHeight;}
resize();window.onresize=resize;

// Player
const player={x:W/2,y:H-100,size:40};

// Chaser
const chaser={x:W/2,y:-50,size:50};

// Stars (collectibles)
let stars=[];

// Game state
function spawnStar(){
  stars.push({
    x:Math.random()*W,
    y:-20,
    size:8+Math.random()*4,
    speed:1.5
  });
}

function update(dt){
  if(!gameRunning)return;
  if(Date.now()-lastScoreTime>=1000){
    score+=1;scoreEl.textContent=score;lastScoreTime=Date.now();
  }
  // Spawn stars
  if(Math.random()<0.01)spawnStar();
  // Update stars
  for(let i=stars.length-1;i>=0;i--){
    const s=stars[i];
    s.y+=s.speed;
    // Collision with player
    const dx=s.x-player.x,dy=s.y-player.y;
    if(Math.hypot(dx,dy)<(s.size+player.size)/2){
      score+=10;scoreEl.textContent=score;
      stars.splice(i,1);
      continue;
    }
    if(s.y>H+50)stars.splice(i,1);
  }
  // Move chaser towards player
  const chaserSpeed = 2 + (Date.now()-startTime)/2000;
  const dx=player.x-chaser.x, dy=player.y-chaser.y;
  const dist=Math.hypot(dx,dy);
  if(dist>0){
    chaser.x+=dx/dist*chaserSpeed;
    chaser.y+=dy/dist*chaserSpeed;
  }
  // Check collision
  if(Math.hypot(chaser.x-player.x,chaser.y-player.y)<(chaser.size+player.size)/2){
    endGame();
  }
}

function draw(){
  ctx.fillStyle='#030014';ctx.fillRect(0,0,W,H);
  // Draw stars
  ctx.fillStyle='#ffffff';
  stars.forEach(s=>{
    ctx.beginPath();ctx.arc(s.x,s.y,s.size/2,0,2*Math.PI);ctx.fill();
  });
  // Draw chaser
  ctx.fillStyle='#3b82f6';
  ctx.beginPath();ctx.arc(chaser.x,chaser.y,chaser.size/2,0,2*Math.PI);ctx.fill();
  // Draw player
  ctx.fillStyle='#a855f7';
  ctx.beginPath();ctx.arc(player.x,player.y,player.size/2,0,2*Math.PI);ctx.fill();
}

function loop(){
  const now=Date.now();
  const dt=now-startTime;
  startTime=now;
  update(dt);
  draw();
  requestAnimationFrame(loop);
}
loop();

// Start time
startTime=Date.now();
lastScoreTime=Date.now();

function endGame(){
  gameRunning=false;
  finalScoreEl.textContent=score;
  gameOverEl.classList.add('show');
}

function restart(){
  score=0;scoreEl.textContent='0';
  stars=[];
  chaser.x=W/2;chaser.y=-50;
  player.x=W/2;
  startTime=Date.now();lastScoreTime=Date.now();
  gameRunning=true;
  gameOverEl.classList.remove('show');
}

restartBtn.addEventListener('click',restart);

// Controls - tap left/right
function handleTap(x){
  const move=60;
  if(x<W/2){
    player.x=Math.max(player.size/2,player.x-move);
  }else{
    player.x=Math.min(W-player.size/2,player.x+move);
  }
  score+=5;scoreEl.textContent=score;
}
canvas.addEventListener('touchstart',e=>{
  e.preventDefault();
  const touch=e.touches[0];
  handleTap(touch.clientX);
});
canvas.addEventListener('mousedown',e=>handleTap(e.clientX));
</script>
</body>
</html>