<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Kawaii Stack Drop</title>
<style>
  html, body {margin:0; padding:0; overflow:hidden; background:#f0f8ff; font-family:sans-serif;}
  canvas {display:block; background:#ffffff;}
  #overlay {
    position:absolute; top:0; left:0; width:100%; height:100%;
    display:flex; align-items:center; justify-content:center;
    background:rgba(255,255,255,0.8); font-size:2rem;
    color:#333; text-align:center; cursor:pointer;
    visibility:hidden;
  }
</style>
</head>
<body>
<canvas id="gameCanvas"></canvas>
<div id="overlay">Game Over<br>Score: <span id="finalScore">0</span><br>Tap to restart</div>
<script>
const canvas=document.getElementById('gameCanvas');
const ctx=canvas.getContext('2d');
const overlay=document.getElementById('overlay');
const finalScore=document.getElementById('finalScore');
let width, height;
function resize(){
  width=window.innerWidth;
  height=window.innerHeight;
  canvas.width=width;
  canvas.height=height;
}
window.addEventListener('resize',resize);
resize();

const blockSize={w:80,h:20};
const stackRadius=120;
const stackCenter={x:width/2,y:height/2};
let stackAngle=0;
const rotationSpeed=0.02;
const blocks=[];
let fallingBlock=null;
let score=0;
let gameOver=false;

function reset(){
  blocks.length=0;
  stackAngle=0;
  fallingBlock=null;
  score=0;
  gameOver=false;
  overlay.style.visibility='hidden';
  spawnBlock();
  requestAnimationFrame(update);
}
function spawnBlock(){
  fallingBlock={y: -50};
}
function update(){
  if(gameOver){return;}
  ctx.clearRect(0,0,width,height);
  stackAngle+=rotationSpeed;
  // Draw stack
  ctx.strokeStyle='#ffb6c1'; ctx.lineWidth=2;
  blocks.forEach((b,i)=>{
    const angle=stackAngle+Math.PI/2+Math.PI*i/blocks.length;
    ctx.save();
    ctx.translate(stackCenter.x,stackCenter.y);
    ctx.rotate(angle);
    ctx.translate(0,-stackRadius);
    ctx.fillStyle='#ffb6c1';
    ctx.fillRect(-blockSize.w/2,-blockSize.h/2,blockSize.w,blockSize.h);
    ctx.restore();
  });
  // Draw falling block
  if(fallingBlock){
    fallingBlock.y+=5;
    ctx.save();
    ctx.translate(stackCenter.x,stackCenter.y);
    ctx.rotate(stackAngle);
    ctx.translate(0,-stackRadius - 50);
    ctx.fillStyle='#ff69b4';
    ctx.fillRect(-blockSize.w/2,fallingBlock.y,blockSize.w,blockSize.h);
    ctx.restore();
    // Check collision
    if(fallingBlock.y+blockSize.h>=-50){
      const tolerance=10;
      const dx=Math.abs(fallingBlock.y+blockSize.h + stackRadius);
      if(dx>tolerance){
        gameOver=true;
        finalScore.textContent=score;
        overlay.style.visibility='visible';
        return;
      }else{
        blocks.push({}); // placeholder, angle handled by stackAngle
        score++;
        spawnBlock();
      }
    }
  }
  requestAnimationFrame(update);
}
canvas.addEventListener('click',()=>{if(gameOver)reset();});
canvas.addEventListener('touchstart',()=>{if(gameOver)reset();});
reset();
</script>
</body>
</html>