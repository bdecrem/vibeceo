<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>TB-303 — SynthMachine</title>
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <main class="panel">
      <div class="header-row">
        <h1>TB-303</h1>
        <div class="header-controls">
          <button id="engine-toggle" class="engine-toggle-mini engine-e2" title="Toggle E1/E2 engine">2</button>
          <button id="info-btn" class="voice-info-btn" title="Synthesis info">i</button>
        </div>
      </div>

      <section class="controls">
        <!-- Waveform toggle -->
        <div class="waveform-toggle">
          <button id="wave-saw" class="wave-btn active" data-wave="sawtooth" title="Sawtooth">
            <svg viewBox="0 0 24 24" width="20" height="20">
              <path d="M2 12 L12 4 L12 20 L22 12" fill="none" stroke="currentColor" stroke-width="2"/>
            </svg>
          </button>
          <button id="wave-square" class="wave-btn" data-wave="square" title="Square">
            <svg viewBox="0 0 24 24" width="20" height="20">
              <path d="M2 16 L2 8 L12 8 L12 16 L22 16" fill="none" stroke="currentColor" stroke-width="2"/>
            </svg>
          </button>
        </div>

        <div class="controls-divider"></div>

        <!-- Synth knobs -->
        <div class="knob-group">
          <div class="knob-wrapper">
            <div class="knob" id="cutoff-knob" data-param="cutoff"></div>
            <span class="knob-label">Cutoff</span>
            <span class="knob-value" id="cutoff-value">50</span>
          </div>
          <div class="knob-wrapper">
            <div class="knob" id="resonance-knob" data-param="resonance"></div>
            <span class="knob-label">Reso</span>
            <span class="knob-value" id="resonance-value">50</span>
          </div>
          <div class="knob-wrapper">
            <div class="knob" id="envmod-knob" data-param="envMod"></div>
            <span class="knob-label">Env Mod</span>
            <span class="knob-value" id="envmod-value">50</span>
          </div>
          <div class="knob-wrapper">
            <div class="knob" id="decay-knob" data-param="decay"></div>
            <span class="knob-label">Decay</span>
            <span class="knob-value" id="decay-value">50</span>
          </div>
          <div class="knob-wrapper">
            <div class="knob" id="accent-knob" data-param="accent"></div>
            <span class="knob-label">Accent</span>
            <span class="knob-value" id="accent-value">80</span>
          </div>
        </div>

        <div class="controls-divider"></div>

        <!-- Transport -->
        <label>
          BPM
          <input id="bpm" type="number" min="60" max="200" step="1" value="130" />
        </label>
        <select id="preset">
          <option value="">— Presets —</option>
        </select>
        <button id="play-toggle" type="button">Play</button>
        <button id="export-btn" type="button" class="export-btn" title="Export WAV">WAV</button>
      </section>

      <div id="status"></div>

      <!-- Step page toggle (mobile only) -->
      <div class="step-page-toggle">
        <button class="step-page-btn active" data-page="1">1-8</button>
        <button class="step-page-btn" data-page="2">9-16</button>
      </div>

      <!-- Sequencer Grid -->
      <section id="sequencer" class="sequencer">
        <div class="seq-row-labels">
          <span class="seq-row-label">Note</span>
          <span class="seq-row-label">Gate</span>
          <span class="seq-row-label">Acc</span>
          <span class="seq-row-label">Slide</span>
        </div>
        <div class="seq-grid" id="seq-steps">
          <!-- Generated by JS: 16 columns of (note, gate, accent, slide) -->
        </div>
        <div class="seq-step-nums">
          <span>1</span><span>2</span><span>3</span><span>4</span>
          <span>5</span><span>6</span><span>7</span><span>8</span>
          <span>9</span><span>10</span><span>11</span><span>12</span>
          <span>13</span><span>14</span><span>15</span><span>16</span>
        </div>
      </section>

      <div class="keyboard-hints">
        <kbd>Space</kbd> Play/Stop &nbsp;|&nbsp;
        <kbd>A</kbd>-<kbd>K</kbd> Play notes
      </div>
    </main>

    <!-- Info Modal -->
    <div id="info-modal" class="voice-info-modal">
      <div class="voice-info-content">
        <div class="voice-info-header">
          <span class="voice-info-title">TB-303 Bass</span>
          <button class="voice-info-close" aria-label="Close">&times;</button>
        </div>
        <div class="voice-info-body">
          <div class="voice-info-section">
            <div class="voice-info-label">E1 — Simple</div>
            <div class="voice-info-text">Standard oscillator with biquad lowpass filter. Clean sound, minimal CPU usage.</div>
          </div>
          <div class="voice-info-section">
            <div class="voice-info-label e2">E2 — Authentic</div>
            <div class="voice-info-text">Diode ladder filter (~18dB/oct) with resonance self-oscillation. Accent boosts both VCA and filter modulation. The authentic acid squelch.</div>
          </div>
        </div>
      </div>
    </div>

    <script type="module" src="../../dist/ui/tb303/app.js"></script>
  </body>
</html>
