# JP9000 Modular Synth Reference

You are helping the user work with the **JP9000**, a text-controllable modular synthesizer.

**User request**: $ARGUMENTS

## JP9000 Overview

The JP9000 is a **virtual modular synth** where you:
1. Add modules to a rack
2. Connect them with patch cables
3. Set parameters on each module
4. Trigger/sequence them

It's like a Eurorack system you build with text commands.

## Jambot Tools

| Tool | Purpose |
|------|---------|
| `add_jp9000` | Initialize with optional preset (basic, pluck, dualBass) |
| `add_module` | Add a module to the rack |
| `remove_module` | Remove a module |
| `connect_modules` | Patch two ports together |
| `disconnect_modules` | Remove a patch cable |
| `set_jp9000_output` | Set final output module |
| `tweak_module` | Adjust module parameters |
| `set_trigger_modules` | Which modules respond to pattern |
| `add_jp9000_pattern` | Set note sequence |
| `show_jp9000` | Display current rack state |
| `list_module_types` | Show available modules |
| `save_jp9000_rig` | Save rack config to file |
| `load_jp9000_rig` | Load a saved rig |
| `list_jp9000_rigs` | Show saved rigs |

## Available Modules

### Sound Sources
| Type | Name | Outputs | Key Params |
|------|------|---------|------------|
| `osc-saw` | Sawtooth Oscillator | audio | frequency, octave |
| `osc-square` | Square Oscillator | audio | frequency, octave, pulseWidth |
| `osc-triangle` | Triangle Oscillator | audio | frequency, octave |
| `string` | Karplus-Strong String | audio | frequency, decay, brightness, pluckPosition |

### Filters
| Type | Name | Inputs | Outputs | Key Params |
|------|------|--------|---------|------------|
| `filter-lp24` | 24dB Lowpass | audio, cutoffCV | audio | cutoff, resonance, envAmount |
| `filter-biquad` | Biquad Filter | audio | audio | frequency, Q, type |

### Modulation
| Type | Name | Outputs | Key Params |
|------|------|---------|------------|
| `env-adsr` | ADSR Envelope | cv | attack, decay, sustain, release |
| `sequencer` | Step Sequencer | cv, gate | steps, values |

### Utilities
| Type | Name | Inputs | Outputs | Key Params |
|------|------|--------|---------|------------|
| `vca` | VCA | audio, cv | audio | gain |
| `mixer` | 4-Ch Mixer | in1-in4 | audio | gain1-gain4 |

### Effects
| Type | Name | Inputs | Outputs | Key Params |
|------|------|--------|---------|------------|
| `drive` | Saturation | audio | audio | amount, type (1=soft, 2=tube, 3=hard) |

## Port Naming Convention

Ports are addressed as `moduleId.portName`:
- `osc1.audio` — audio output of osc1
- `filter1.audio` — audio input/output of filter1
- `env1.cv` — control voltage output of envelope
- `filter1.cutoffCV` — CV input for filter cutoff modulation

## Presets

### `basic` — Subtractive Synth
```
osc-saw → filter-lp24 → vca → output
              ↑          ↑
           env-adsr ─────┘
```

### `pluck` — Karplus-Strong String
```
string → filter-lp24 → drive → output
```

### `dualBass` — Dual Oscillator Bass
```
osc-saw ──┬─► mixer → filter-lp24 → vca → drive → output
osc-square┘       ↑          ↑        ↑
               env-adsr ─────┴────────┘
```

## Building a Patch from Scratch

```
1. add_jp9000()                              # Start empty
2. add_module({ type: 'osc-saw', id: 'osc1' })
3. add_module({ type: 'filter-lp24', id: 'filter1' })
4. add_module({ type: 'env-adsr', id: 'env1' })
5. add_module({ type: 'vca', id: 'vca1' })
6. connect_modules({ from: 'osc1.audio', to: 'filter1.audio' })
7. connect_modules({ from: 'env1.cv', to: 'filter1.cutoffCV' })
8. connect_modules({ from: 'filter1.audio', to: 'vca1.audio' })
9. connect_modules({ from: 'env1.cv', to: 'vca1.cv' })
10. set_jp9000_output({ module: 'vca1' })
11. set_trigger_modules({ modules: ['osc1'] })
```

## The String Module (Karplus-Strong)

The **killer feature** of JP9000. Physical modeling synthesis:

| Param | Range | Description |
|-------|-------|-------------|
| `frequency` | 20-2000 Hz | Pitch (or use note names) |
| `decay` | 0-100 | How long the string rings |
| `brightness` | 0-100 | High frequency content |
| `pluckPosition` | 0-100 | Where you pluck (affects harmonics) |

**Tips:**
- Low brightness = muted, dull
- High brightness = bright, metallic
- PluckPosition 50 = center (fundamental), 10-20 = near bridge (bright)
- Decay 90+ = nearly infinite sustain

## Pattern Format

```javascript
[
  { note: 'E2', gate: true, velocity: 1 },
  { note: null, gate: false },
  { note: 'E2', gate: true, velocity: 0.7 },
  // ... 16 steps
]
```

## Rig Management

Save your patches for later:

```
// After building a cool patch:
save_jp9000_rig({ name: 'dark-pluck', description: 'Muted string with drive' })

// Later:
load_jp9000_rig({ name: 'dark-pluck' })

// See what's saved:
list_jp9000_rigs()
```

Rigs are stored in `~/Documents/Jambot/rigs/`

## Sound Design Ideas

### Plucked Bass
- string module, decay 60-70, brightness 40
- filter-lp24 cutoff 800-1200
- light drive (20-30)

### Bell/Marimba
- string module, high brightness (80+)
- short decay (30-40)
- pluckPosition near center (40-60)

### Growling Bass
- dual oscillators (saw + square one octave down)
- filter with high resonance (60+)
- env modulating cutoff
- heavy drive (50-70)

### Pad/Drone
- triangle oscillator
- long envelope (attack 40+, release 60+)
- low cutoff, gentle modulation
- no drive

---

Now help the user with their JP9000 request. If they want to build a patch, walk them through it step by step. If they want a specific sound, suggest module combinations and parameter values.
